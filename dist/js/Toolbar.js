function Toolbar(t,e){this.editorUi=t,this.container=e,this.staticElements=[],this.init(),this.gestureHandler=mxUtils.bind(this,function(t){null!=this.editorUi.currentMenu&&mxEvent.getSource(t)!=this.editorUi.currentMenu.div&&this.hideMenu()}),mxEvent.addGestureListeners(document,this.gestureHandler)}Toolbar.prototype.dropdownImage=mxClient.IS_SVG?"data:image/gif;base64,R0lGODlhDQANAIABAHt7e////yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCREM1NkJFMjE0NEMxMUU1ODk1Q0M5MjQ0MTA4QjNDMSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCREM1NkJFMzE0NEMxMUU1ODk1Q0M5MjQ0MTA4QjNDMSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkQzOUMzMjZCMTQ0QjExRTU4OTVDQzkyNDQxMDhCM0MxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkQzOUMzMjZDMTQ0QjExRTU4OTVDQzkyNDQxMDhCM0MxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAQAsAAAAAA0ADQAAAhGMj6nL3QAjVHIu6azbvPtWAAA7":IMAGE_PATH+"/dropdown.gif",Toolbar.prototype.dropdownImageHtml='<img border="0" style="position:absolute;right:4px;top:'+(EditorUi.compactUi?6:8)+'px;" src="'+Toolbar.prototype.dropdownImage+'" valign="middle"/>',Toolbar.prototype.selectedBackground="#d0d0d0",Toolbar.prototype.unselectedBackground="none",Toolbar.prototype.staticElements=null,Toolbar.prototype.init=function(){var t=screen.width,e=(700<=(t-=740<screen.height?56:0)&&(n=this.addMenu("",mxResources.get("view")+" ("+mxResources.get("panTooltip")+")",!0,"viewPanels",null,!0),this.addDropDownArrow(n,"geSprite-formatpanel",38,50,-4,-3,36,-8),this.addSeparator()),this.addMenu("",mxResources.get("zoom")+" (Alt+Mousewheel)",!0,"viewZoom",null,!0)),i=(e.showDisabled=!0,e.style.whiteSpace="nowrap",e.style.position="relative",e.style.overflow="hidden",EditorUi.compactUi?e.style.width=mxClient.IS_QUIRKS?"58px":"50px":e.style.width=mxClient.IS_QUIRKS?"62px":"36px",420<=t&&(this.addSeparator(),(i=this.addItems(["zoomIn","zoomOut"]))[0].setAttribute("title",mxResources.get("zoomIn")+" ("+this.editorUi.actions.get("zoomIn").shortcut+")"),i[1].setAttribute("title",mxResources.get("zoomOut")+" ("+this.editorUi.actions.get("zoomOut").shortcut+")")),this.updateZoom=mxUtils.bind(this,function(){e.innerHTML=Math.round(100*this.editorUi.editor.graph.view.scale)+"%"+this.dropdownImageHtml,EditorUi.compactUi&&(e.getElementsByTagName("img")[0].style.right="1px",e.getElementsByTagName("img")[0].style.top="5px")}),this.editorUi.editor.graph.view.addListener(mxEvent.EVENT_SCALE,this.updateZoom),this.editorUi.editor.addListener("resetGraphView",this.updateZoom),this.addItems(["-","undo","redo"])),n=(i[1].setAttribute("title",mxResources.get("undo")+" ("+this.editorUi.actions.get("undo").shortcut+")"),i[2].setAttribute("title",mxResources.get("redo")+" ("+this.editorUi.actions.get("redo").shortcut+")"),320<=t&&(i=this.addItems(["-","delete"]))[1].setAttribute("title",mxResources.get("delete")+" ("+this.editorUi.actions.get("delete").shortcut+")"),550<=t&&this.addItems(["-","toFront","toBack"]),740<=t&&(this.addItems(["-","fillColor"]),780<=t&&(this.addItems(["strokeColor"]),820<=t&&this.addItems(["shadow"]))),400<=t&&(this.addSeparator(),440<=t&&(this.edgeShapeMenu=this.addMenuFunction("",mxResources.get("connection"),!1,mxUtils.bind(this,function(t){this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_SHAPE,"width"],[null,null],"geIcon geSprite geSprite-connection",null,!0).setAttribute("title",mxResources.get("line")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_SHAPE,"width"],["link",null],"geIcon geSprite geSprite-linkedge",null,!0).setAttribute("title",mxResources.get("link")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_SHAPE,"width"],["flexArrow",null],"geIcon geSprite geSprite-arrow",null,!0).setAttribute("title",mxResources.get("arrow")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_SHAPE,"width"],["arrow",null],"geIcon geSprite geSprite-simplearrow",null,!0).setAttribute("title",mxResources.get("simpleArrow"))})),this.addDropDownArrow(this.edgeShapeMenu,"geSprite-connection",44,50,0,0,22,-4)),this.edgeStyleMenu=this.addMenuFunction("geSprite-orthogonal",mxResources.get("waypoints"),!1,mxUtils.bind(this,function(t){this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],[null,null,null],"geIcon geSprite geSprite-straight",null,!0).setAttribute("title",mxResources.get("straight")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle",null,null],"geIcon geSprite geSprite-orthogonal",null,!0).setAttribute("title",mxResources.get("orthogonal")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalelbow",null,!0).setAttribute("title",mxResources.get("simple")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalelbow",null,!0).setAttribute("title",mxResources.get("simple")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalisometric",null,!0).setAttribute("title",mxResources.get("isometric")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalisometric",null,!0).setAttribute("title",mxResources.get("isometric")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle","1",null],"geIcon geSprite geSprite-curved",null,!0).setAttribute("title",mxResources.get("curved")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["entityRelationEdgeStyle",null,null],"geIcon geSprite geSprite-entity",null,!0).setAttribute("title",mxResources.get("entityRelation"))})),this.addDropDownArrow(this.edgeStyleMenu,"geSprite-orthogonal",44,50,0,0,22,-4)),this.addSeparator(),this.addMenu("",mxResources.get("insert")+" ("+mxResources.get("doubleClickTooltip")+")",!0,"insert",null,!0));this.addDropDownArrow(n,"geSprite-plus",38,48,-4,-3,36,-8),this.addTableDropDown()},Toolbar.prototype.addTableDropDown=function(){this.addSeparator();var t=this.addMenuFunction("geIcon geSprite geSprite-table",mxResources.get("table"),!1,mxUtils.bind(this,function(t){var e=this.editorUi.editor.graph,i=e.getSelectionCell();e.isTableCell(i)||e.isTableRow(i)||e.isTable(i)?(t.addItem("",null,mxUtils.bind(this,function(){try{e.insertTableColumn(i,!0)}catch(t){this.editorUi.handleError(t)}}),null,"geIcon geSprite geSprite-insertcolumnbefore").setAttribute("title",mxResources.get("insertColumnBefore")),t.addItem("",null,mxUtils.bind(this,function(){try{e.insertTableColumn(i,!1)}catch(t){this.editorUi.handleError(t)}}),null,"geIcon geSprite geSprite-insertcolumnafter").setAttribute("title",mxResources.get("insertColumnAfter")),t.addItem("Delete column",null,mxUtils.bind(this,function(){if(null!=i)try{e.deleteTableColumn(i)}catch(t){this.editorUi.handleError(t)}}),null,"geIcon geSprite geSprite-deletecolumn").setAttribute("title",mxResources.get("deleteColumn")),t.addItem("",null,mxUtils.bind(this,function(){try{e.insertTableRow(i,!0)}catch(t){this.editorUi.handleError(t)}}),null,"geIcon geSprite geSprite-insertrowbefore").setAttribute("title",mxResources.get("insertRowBefore")),t.addItem("",null,mxUtils.bind(this,function(){try{e.insertTableRow(i,!1)}catch(t){this.editorUi.handleError(t)}}),null,"geIcon geSprite geSprite-insertrowafter").setAttribute("title",mxResources.get("insertRowAfter")),t.addItem("",null,mxUtils.bind(this,function(){try{e.deleteTableRow(i)}catch(t){this.editorUi.handleError(t)}}),null,"geIcon geSprite geSprite-deleterow").setAttribute("title",mxResources.get("deleteRow"))):this.editorUi.menus.addInsertTableCellItem(t)})),e=(t.style.position="relative",t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.innerHTML='<div class="geSprite geSprite-table" style="margin-left:-2px;"></div>'+this.dropdownImageHtml,t.style.width=mxClient.IS_QUIRKS?"50px":"30px",EditorUi.compactUi&&(t.getElementsByTagName("img")[0].style.left="22px",t.getElementsByTagName("img")[0].style.top="5px"),this.editorUi.menus.get("insert"));return null!=e&&"function"==typeof t.setEnabled&&e.addListener("stateChanged",function(){t.setEnabled(e.enabled)}),t},Toolbar.prototype.addDropDownArrow=function(t,e,i,n,o,l,s,r){s=null!=s?s:32,o=EditorUi.compactUi?o:r,t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.style.position="relative",t.innerHTML='<div class="geSprite '+e+'" style="margin-left:'+o+"px;margin-top:"+l+'px;"></div>'+this.dropdownImageHtml,t.style.width=mxClient.IS_QUIRKS?n+"px":n-s+"px",mxClient.IS_QUIRKS&&(t.style.height=EditorUi.compactUi?"24px":"26px"),EditorUi.compactUi&&(t.getElementsByTagName("img")[0].style.left="24px",t.getElementsByTagName("img")[0].style.top="5px",t.style.width=mxClient.IS_QUIRKS?i+"px":i-10+"px")},Toolbar.prototype.setFontName=function(t){null!=this.fontMenu&&(this.fontMenu.innerHTML='<div style="width:60px;overflow:hidden;display:inline-block;">'+mxUtils.htmlEntities(t)+"</div>"+this.dropdownImageHtml)},Toolbar.prototype.setFontSize=function(t){null!=this.sizeMenu&&(this.sizeMenu.innerHTML='<div style="width:24px;overflow:hidden;display:inline-block;">'+mxUtils.htmlEntities(t)+"</div>"+this.dropdownImageHtml)},Toolbar.prototype.createTextToolbar=function(){var l=this.editorUi.editor.graph,t=this.addMenu("",mxResources.get("style"),!0,"formatBlock"),t=(t.style.position="relative",t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.innerHTML=mxResources.get("style")+this.dropdownImageHtml,EditorUi.compactUi&&(t.style.paddingRight="18px",t.getElementsByTagName("img")[0].style.right="1px",t.getElementsByTagName("img")[0].style.top="5px"),this.addSeparator(),this.fontMenu=this.addMenu("",mxResources.get("fontFamily"),!0,"fontFamily"),this.fontMenu.style.position="relative",this.fontMenu.style.whiteSpace="nowrap",this.fontMenu.style.overflow="hidden",this.fontMenu.style.width=mxClient.IS_QUIRKS?"80px":"60px",this.setFontName(Menus.prototype.defaultFont),EditorUi.compactUi&&(this.fontMenu.style.paddingRight="18px",this.fontMenu.getElementsByTagName("img")[0].style.right="1px",this.fontMenu.getElementsByTagName("img")[0].style.top="5px"),this.addSeparator(),this.sizeMenu=this.addMenu(Menus.prototype.defaultFontSize,mxResources.get("fontSize"),!0,"fontSize"),this.sizeMenu.style.position="relative",this.sizeMenu.style.whiteSpace="nowrap",this.sizeMenu.style.overflow="hidden",this.sizeMenu.style.width=mxClient.IS_QUIRKS?"44px":"24px",this.setFontSize(Menus.prototype.defaultFontSize),EditorUi.compactUi&&(this.sizeMenu.style.paddingRight="18px",this.sizeMenu.getElementsByTagName("img")[0].style.right="1px",this.sizeMenu.getElementsByTagName("img")[0].style.top="5px"),this.addItems(["-","undo","redo","-","bold","italic","underline"])),t=(t[1].setAttribute("title",mxResources.get("undo")+" ("+this.editorUi.actions.get("undo").shortcut+")"),t[2].setAttribute("title",mxResources.get("redo")+" ("+this.editorUi.actions.get("redo").shortcut+")"),t[4].setAttribute("title",mxResources.get("bold")+" ("+this.editorUi.actions.get("bold").shortcut+")"),t[5].setAttribute("title",mxResources.get("italic")+" ("+this.editorUi.actions.get("italic").shortcut+")"),t[6].setAttribute("title",mxResources.get("underline")+" ("+this.editorUi.actions.get("underline").shortcut+")"),this.addMenuFunction("",mxResources.get("align"),!1,mxUtils.bind(this,function(t){(e=t.addItem("",null,mxUtils.bind(this,function(t){l.cellEditor.alignText(mxConstants.ALIGN_LEFT,t)}),null,"geIcon geSprite geSprite-left")).setAttribute("title",mxResources.get("left")),(e=t.addItem("",null,mxUtils.bind(this,function(t){l.cellEditor.alignText(mxConstants.ALIGN_CENTER,t)}),null,"geIcon geSprite geSprite-center")).setAttribute("title",mxResources.get("center")),(e=t.addItem("",null,mxUtils.bind(this,function(t){l.cellEditor.alignText(mxConstants.ALIGN_RIGHT,t)}),null,"geIcon geSprite geSprite-right")).setAttribute("title",mxResources.get("right")),(e=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("justifyfull",!1,null)}),null,"geIcon geSprite geSprite-justifyfull")).setAttribute("title",mxResources.get("justifyfull")),(e=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("insertorderedlist",!1,null)}),null,"geIcon geSprite geSprite-orderedlist")).setAttribute("title",mxResources.get("numberedList")),(e=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("insertunorderedlist",!1,null)}),null,"geIcon geSprite geSprite-unorderedlist")).setAttribute("title",mxResources.get("bulletedList")),(e=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("outdent",!1,null)}),null,"geIcon geSprite geSprite-outdent")).setAttribute("title",mxResources.get("decreaseIndent")),(e=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("indent",!1,null)}),null,"geIcon geSprite geSprite-indent")).setAttribute("title",mxResources.get("increaseIndent"))}))),t=(t.style.position="relative",t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.innerHTML='<div class="geSprite geSprite-left" style="margin-left:-2px;"></div>'+this.dropdownImageHtml,t.style.width=mxClient.IS_QUIRKS?"50px":"30px",EditorUi.compactUi&&(t.getElementsByTagName("img")[0].style.left="22px",t.getElementsByTagName("img")[0].style.top="5px"),this.addMenuFunction("",mxResources.get("format"),!1,mxUtils.bind(this,function(t){(e=t.addItem("",null,this.editorUi.actions.get("subscript").funct,null,"geIcon geSprite geSprite-subscript")).setAttribute("title",mxResources.get("subscript")+" ("+Editor.ctrlKey+"+,)"),(e=t.addItem("",null,this.editorUi.actions.get("superscript").funct,null,"geIcon geSprite geSprite-superscript")).setAttribute("title",mxResources.get("superscript")+" ("+Editor.ctrlKey+"+.)"),(e=t.addItem("",null,this.editorUi.actions.get("fontColor").funct,null,"geIcon geSprite geSprite-fontcolor")).setAttribute("title",mxResources.get("fontColor")),(e=t.addItem("",null,this.editorUi.actions.get("backgroundColor").funct,null,"geIcon geSprite geSprite-fontbackground")).setAttribute("title",mxResources.get("backgroundColor")),(e=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("removeformat",!1,null)}),null,"geIcon geSprite geSprite-removeformat")).setAttribute("title",mxResources.get("removeFormat"))}))),t=(t.style.position="relative",t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.innerHTML='<div class="geSprite geSprite-dots" style="margin-left:-2px;"></div>'+this.dropdownImageHtml,t.style.width=mxClient.IS_QUIRKS?"50px":"30px",EditorUi.compactUi&&(t.getElementsByTagName("img")[0].style.left="22px",t.getElementsByTagName("img")[0].style.top="5px"),this.addSeparator(),this.addButton("geIcon geSprite geSprite-code",mxResources.get("html"),function(){l.cellEditor.toggleViewMode(),0<l.cellEditor.textarea.innerHTML.length&&("&nbsp;"!=l.cellEditor.textarea.innerHTML||!l.cellEditor.clearOnChange)&&window.setTimeout(function(){document.execCommand("selectAll",!1,null)})}),this.addSeparator(),this.addMenuFunction("",mxResources.get("insert"),!0,mxUtils.bind(this,function(t){t.addItem(mxResources.get("insertLink"),null,mxUtils.bind(this,function(){this.editorUi.actions.get("link").funct()})),t.addItem(mxResources.get("insertImage"),null,mxUtils.bind(this,function(){this.editorUi.actions.get("image").funct()})),t.addItem(mxResources.get("insertHorizontalRule"),null,mxUtils.bind(this,function(){document.execCommand("inserthorizontalrule",!1,null)}))}))),e=(t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.style.position="relative",t.innerHTML='<div class="geSprite geSprite-plus" style="margin-left:-4px;margin-top:-3px;"></div>'+this.dropdownImageHtml,t.style.width=mxClient.IS_QUIRKS?"36px":"16px",EditorUi.compactUi&&(t.getElementsByTagName("img")[0].style.left="24px",t.getElementsByTagName("img")[0].style.top="5px",t.style.width=mxClient.IS_QUIRKS?"50px":"30px"),this.addSeparator(),this.addMenuFunction("geIcon geSprite geSprite-table",mxResources.get("table"),!1,mxUtils.bind(this,function(t){var e,i=l.getSelectedElement(),n=l.getParentByNames(i,["TD","TH"],l.cellEditor.text2),o=l.getParentByName(i,"TR",l.cellEditor.text2);null==o?this.editorUi.menus.addInsertTableItem(t):(e=l.getParentByName(o,"TABLE",l.cellEditor.text2),(i=t.addItem("",null,mxUtils.bind(this,function(){try{l.selectNode(l.insertColumn(e,null!=n?n.cellIndex:0))}catch(t){this.editorUi.handleError(t)}}),null,"geIcon geSprite geSprite-insertcolumnbefore")).setAttribute("title",mxResources.get("insertColumnBefore")),(i=t.addItem("",null,mxUtils.bind(this,function(){try{l.selectNode(l.insertColumn(e,null!=n?n.cellIndex+1:-1))}catch(t){this.editorUi.handleError(t)}}),null,"geIcon geSprite geSprite-insertcolumnafter")).setAttribute("title",mxResources.get("insertColumnAfter")),(i=t.addItem("Delete column",null,mxUtils.bind(this,function(){if(null!=n)try{l.deleteColumn(e,n.cellIndex)}catch(t){this.editorUi.handleError(t)}}),null,"geIcon geSprite geSprite-deletecolumn")).setAttribute("title",mxResources.get("deleteColumn")),(i=t.addItem("",null,mxUtils.bind(this,function(){try{l.selectNode(l.insertRow(e,o.sectionRowIndex))}catch(t){this.editorUi.handleError(t)}}),null,"geIcon geSprite geSprite-insertrowbefore")).setAttribute("title",mxResources.get("insertRowBefore")),(i=t.addItem("",null,mxUtils.bind(this,function(){try{l.selectNode(l.insertRow(e,o.sectionRowIndex+1))}catch(t){this.editorUi.handleError(t)}}),null,"geIcon geSprite geSprite-insertrowafter")).setAttribute("title",mxResources.get("insertRowAfter")),(i=t.addItem("",null,mxUtils.bind(this,function(){try{l.deleteRow(e,o.sectionRowIndex)}catch(t){this.editorUi.handleError(t)}}),null,"geIcon geSprite geSprite-deleterow")).setAttribute("title",mxResources.get("deleteRow")),(i=t.addItem("",null,mxUtils.bind(this,function(){var t=e.style.borderColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(t,e,i,n){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)});this.editorUi.pickColor(t,function(t){null==t||t==mxConstants.NONE?(e.removeAttribute("border"),e.style.border="",e.style.borderCollapse=""):(e.setAttribute("border","1"),e.style.border="1px solid "+t,e.style.borderCollapse="collapse")})}),null,"geIcon geSprite geSprite-strokecolor")).setAttribute("title",mxResources.get("borderColor")),(i=t.addItem("",null,mxUtils.bind(this,function(){var t=e.style.backgroundColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(t,e,i,n){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)});this.editorUi.pickColor(t,function(t){null==t||t==mxConstants.NONE?e.style.backgroundColor="":e.style.backgroundColor=t})}),null,"geIcon geSprite geSprite-fillcolor")).setAttribute("title",mxResources.get("backgroundColor")),(i=t.addItem("",null,mxUtils.bind(this,function(){var t=e.getAttribute("cellPadding")||0,t=new FilenameDialog(this.editorUi,t,mxResources.get("apply"),mxUtils.bind(this,function(t){null!=t&&0<t.length?e.setAttribute("cellPadding",t):e.removeAttribute("cellPadding")}),mxResources.get("spacing"));this.editorUi.showDialog(t.container,300,80,!0,!0),t.init()}),null,"geIcon geSprite geSprite-fit")).setAttribute("title",mxResources.get("spacing")),(i=t.addItem("",null,mxUtils.bind(this,function(){e.setAttribute("align","left")}),null,"geIcon geSprite geSprite-left")).setAttribute("title",mxResources.get("left")),(i=t.addItem("",null,mxUtils.bind(this,function(){e.setAttribute("align","center")}),null,"geIcon geSprite geSprite-center")).setAttribute("title",mxResources.get("center")),(i=t.addItem("",null,mxUtils.bind(this,function(){e.setAttribute("align","right")}),null,"geIcon geSprite geSprite-right")).setAttribute("title",mxResources.get("right")))})));e.style.position="relative",e.style.whiteSpace="nowrap",e.style.overflow="hidden",e.innerHTML='<div class="geSprite geSprite-table" style="margin-left:-2px;"></div>'+this.dropdownImageHtml,e.style.width=mxClient.IS_QUIRKS?"50px":"30px",EditorUi.compactUi&&(e.getElementsByTagName("img")[0].style.left="22px",e.getElementsByTagName("img")[0].style.top="5px")},Toolbar.prototype.hideMenu=function(){this.editorUi.hideCurrentMenu()},Toolbar.prototype.addMenu=function(t,e,i,n,o,l,s){var r=this.editorUi.menus.get(n),d=this.addMenuFunction(t,e,i,function(){r.funct.apply(r,arguments)},o,l);return s||"function"!=typeof d.setEnabled||r.addListener("stateChanged",function(){d.setEnabled(r.enabled)}),d},Toolbar.prototype.addMenuFunction=function(t,e,i,n,o,l){return this.addMenuFunctionInContainer(null!=o?o:this.container,t,e,i,n,l)},Toolbar.prototype.addMenuFunctionInContainer=function(t,e,i,n,o,l){e=n?this.createLabel(e):this.createButton(e);return this.initElement(e,i),this.addMenuHandler(e,n,o,l),t.appendChild(e),e},Toolbar.prototype.addSeparator=function(t){t=null!=t?t:this.container;var e=document.createElement("div");return e.className="geSeparator",t.appendChild(e),e},Toolbar.prototype.addItems=function(t,e,i){for(var n=[],o=0;o<t.length;o++){var l=t[o];"-"==l?n.push(this.addSeparator(e)):n.push(this.addItem("geSprite-"+l.toLowerCase(),l,e,i))}return n},Toolbar.prototype.addItem=function(t,e,i,n){var o=this.editorUi.actions.get(e),l=null;return null!=o&&(e=o.label,null!=o.shortcut&&(e+=" ("+o.shortcut+")"),l=this.addButton(t,e,o.funct,i),n||"function"!=typeof l.setEnabled||(l.setEnabled(o.enabled),o.addListener("stateChanged",function(){l.setEnabled(o.enabled)}))),l},Toolbar.prototype.addButton=function(t,e,i,n){t=this.createButton(t);return n=null!=n?n:this.container,this.initElement(t,e),this.addClickHandler(t,i),n.appendChild(t),t},Toolbar.prototype.initElement=function(t,e){null!=e&&t.setAttribute("title",e),this.addEnabledState(t)},Toolbar.prototype.addEnabledState=function(e){var i=e.className;e.setEnabled=function(t){e.enabled=t,e.className=t?i:i+" mxDisabled"},e.setEnabled(!0)},Toolbar.prototype.addClickHandler=function(e,i){null!=i&&(mxEvent.addListener(e,"click",function(t){e.enabled&&i(t),mxEvent.consume(t)}),mxEvent.addListener(e,mxClient.IS_POINTER?"pointerdown":"mousedown",mxUtils.bind(this,function(t){t.preventDefault()})))},Toolbar.prototype.createButton=function(t){var e=document.createElement("a"),i=(e.className="geButton",document.createElement("div"));return null!=t&&(i.className="geSprite "+t),e.appendChild(i),e},Toolbar.prototype.createLabel=function(t,e){var i=document.createElement("a");return i.className="geLabel",mxUtils.write(i,t),i},Toolbar.prototype.addMenuHandler=function(i,n,o,l){var s,r,d;null!=o&&(s=this.editorUi.editor.graph,d=!(r=null),mxEvent.addListener(i,"click",mxUtils.bind(this,function(t){var e;d&&(null==i.enabled||i.enabled)&&(s.popupMenuHandler.hideMenu(),(r=new mxPopupMenu(o)).div.className+=" geToolbarMenu",r.showDisabled=l,r.labels=n,r.autoExpand=!0,e=mxUtils.getOffset(i),r.popup(e.x,e.y+i.offsetHeight,null,t),this.editorUi.setCurrentMenu(r,i),!n&&r.div.scrollHeight>r.div.clientHeight&&(r.div.style.width="40px"),r.hideMenu=mxUtils.bind(this,function(){mxPopupMenu.prototype.hideMenu.apply(r,arguments),this.editorUi.resetCurrentMenu(),r.destroy()}),r.addListener(mxEvent.EVENT_HIDE,mxUtils.bind(this,function(){this.currentElt=null}))),d=!0,mxEvent.consume(t)})),mxEvent.addListener(i,mxClient.IS_POINTER?"pointerdown":"mousedown",mxUtils.bind(this,function(t){d=this.currentElt!=i,t.preventDefault()})))},Toolbar.prototype.destroy=function(){null!=this.gestureHandler&&(mxEvent.removeGestureListeners(document,this.gestureHandler),this.gestureHandler=null)};